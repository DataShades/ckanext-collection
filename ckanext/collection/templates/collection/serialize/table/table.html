{% import "macros/form.html" as form %}
{% set sort_name = collection.name ~ ":sort" %}
{% set sort_value = collection.params.sort %}

{% block table %}
    <table id="{{ collection.serializer.table_id }}" class="table collection-table">

        {% block header %}
            <tr class="collection-table--row collection-table--header">
                {% for col in collection.columns.names if col in collection.columns.visible %}
                    {% set is_sortable = col in collection.columns.sortable %}
                    {% set normal_order = collection.columns.get_normal_order(col) %}
                    {% set reverse_order = collection.columns.get_reverse_order(col) %}

                    {% set is_current_order = sort_value == col %}

                    <td class="collection-table--cell
                               {{- ' collection-table--cell-sortable' if is_sortable }}
                               {{- ' collection-table--cell-sortable--asc' if sort_value == normal_order }}
                               {{- ' collection-table--cell-sortable--desc' if sort_value == reverse_order }}">
                        {% block cell scoped %}
                            {% if is_sortable %}
                                <a class="sort-trigger"
                                   href="{{ h.remove_url_param(sort_name, replace=reverse_order if sort_value == normal_order else normal_order) }}">
                                    {{ collection.columns.labels[col] or col }}
                                </a>
                            {% else %}
                                <span>{{ collection.columns.labels[col] or col }}</span>
                            {% endif %}
                        {% endblock cell %}

                    </td>
                {% endfor %}
            </tr>
        {% endblock header %}

        {% block body %}
            {% for record in collection %}
                {% snippet collection.serializer.record_template, record=record, collection=collection %}
            {% endfor %}

        {% endblock body %}
    </table>
{% endblock table %}
