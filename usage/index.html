
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://datashades.github.io/ckanext-collection/usage/">
      
      
        <link rel="prev" href="../installation/">
      
      
        <link rel="next" href="../interfaces/">
      
      
      <link rel="icon" href="../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.27">
    
    
      
        <title>Usage - ckanext-collection</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#usage" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="ckanext-collection" class="md-header__button md-logo" aria-label="ckanext-collection" data-md-component="logo">
      
  <img src="../img/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ckanext-collection
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Usage
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/DataShades/ckanext-collection" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ckanext-collection" class="md-nav__button md-logo" aria-label="ckanext-collection" data-md-component="logo">
      
  <img src="../img/logo.png" alt="logo">

    </a>
    ckanext-collection
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/DataShades/ckanext-collection" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Usage
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Usage
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#register-collection" class="md-nav__link">
    <span class="md-ellipsis">
      Register collection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#initialize-collection" class="md-nav__link">
    <span class="md-ellipsis">
      Initialize collection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-collection-data" class="md-nav__link">
    <span class="md-ellipsis">
      Use collection data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#serialize-collection" class="md-nav__link">
    <span class="md-ellipsis">
      Serialize collection
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../interfaces/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interfaces
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../structure/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Structure
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Structure
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../structure/collection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Collection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../structure/columns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Columns
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../structure/data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../structure/filters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Filters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../structure/serializer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Serializer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../structure/pager/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pager
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../api/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    API
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../integrations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Integrations
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../detailed/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deep dive
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#register-collection" class="md-nav__link">
    <span class="md-ellipsis">
      Register collection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#initialize-collection" class="md-nav__link">
    <span class="md-ellipsis">
      Initialize collection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-collection-data" class="md-nav__link">
    <span class="md-ellipsis">
      Use collection data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#serialize-collection" class="md-nav__link">
    <span class="md-ellipsis">
      Serialize collection
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="usage">Usage</h1>
<h2 id="register-collection">Register collection</h2>
<p>Collection can be initialized anywhere in code</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">my.module</span> <span class="kn">import</span> <span class="n">MyCollection</span>

<span class="n">col</span> <span class="o">=</span> <span class="n">MyCollection</span><span class="p">()</span>
</code></pre></div>
</div>
<p>But it's recommended to register collections globally.</p>
<p>Collections are registered via <a href="../interfaces/#icollection">ICollection
interface</a> or via CKAN signals. Registered
collection can be initialized anywhere in code using helper. It can also be
used in a number of generic endpoints that render collection as HTML or export
it into different formats.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Register via interface</label><label for="__tabbed_1_2">Register via signal</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">ckan.plugins</span> <span class="k">as</span> <span class="nn">p</span>
<span class="kn">from</span> <span class="nn">ckanext.collection</span> <span class="kn">import</span> <span class="n">shared</span>

<span class="k">class</span> <span class="nc">MyPlugin</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">SingletonPlugin</span><span class="p">):</span>
    <span class="n">p</span><span class="o">.</span><span class="n">implements</span><span class="p">(</span><span class="n">shared</span><span class="o">.</span><span class="n">ICollection</span><span class="p">,</span> <span class="n">inherit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_collection_factories</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">shared</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">CollectionFactory</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;my-collection&quot;</span><span class="p">:</span> <span class="n">MyCollection</span><span class="p">,</span>
        <span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">ckan.plugins</span> <span class="k">as</span> <span class="nn">p</span>

<span class="k">class</span> <span class="nc">MyPlugin</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">SingletonPlugin</span><span class="p">):</span>
    <span class="n">p</span><span class="o">.</span><span class="n">implements</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">ISignal</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_signal_subscriptions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">types</span><span class="o">.</span><span class="n">SignalMapping</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">ckanext</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="s2">&quot;collection:register_collections&quot;</span><span class="p">):</span> <span class="p">[</span>
                <span class="n">get_collection_factories</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">}</span>

<span class="k">def</span> <span class="nf">get_collection_factories</span><span class="p">(</span><span class="n">sender</span><span class="p">:</span> <span class="kc">None</span><span class="p">):</span> <span class="c1"># (1)!</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;my-collection&quot;</span><span class="p">:</span> <span class="n">MyCollection</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre></div>
<ol>
<li>Signal listerners must receive at least one argument containing the sender
   of the signal. Signal that register collections always sets <code>None</code> as a
   sender.</li>
</ol>
</div>
</div>
</div>
<p><code>get_collection_factories</code> returns a dictionary with collection names(letters,
digits, underscores and hyphens are allowed) as keys, and collection factories
as values. In most generic case, collection factory is just a collection's
class itself. But you can use any function with signature <code>(str, dict[str,
Any], **Any) -&gt; Collection</code> as a factory.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>The following function is a valid collection factory and it can be returned
from <code>get_collection_factories</code></p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">my_factory</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Collection that shows 100 numbers per page&quot;&quot;&quot;</span>
    <span class="n">params</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;rows_per_page&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">MyCollection</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
</div>
<h2 id="initialize-collection">Initialize collection</h2>
<p>Collection class defines the data source of collection and different aspects of
it behavior. But collection class itself does not contain any data and
collection instance must be created to work with data.</p>
<p>Any collection can be initialized directly, using collection class. And every
<a href="#register-collection">registered collection</a> can be initialized via
<code>get_collection</code> function. Arguments are the same in both cases. Collection
requires the name, parameters and accepts arbitrary number of keyword-only
arguments, that are passed to underlying services.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">Initialize registered collection</label><label for="__tabbed_2_2">Initialize collection using class</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">col</span> <span class="o">=</span> <span class="n">get_collection</span><span class="p">(</span>
    <span class="s2">&quot;my-collection&quot;</span><span class="p">,</span>
    <span class="p">{},</span>
    <span class="n">pager_settings</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;rows_per_page&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">}</span>
<span class="p">)</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Second argument of <code>get_collection</code> expects parameters prefixed by collection
name. In example above, to choose the second page, you need to pass
<code>{"my-collection:page": 2}</code> as parameters.</p>
<p>If you are using unprefixed parameters, like <code>{"page": 2}</code> and don't want to
adapt them to expected form, pass <code>True</code> as the third argument to
<code>get_collection</code>, and every key inside parameters will get required prefix
automatically.</p>
<div class="highlight"><pre><span></span><code><span class="n">col</span> <span class="o">=</span> <span class="n">get_collection</span><span class="p">(</span>
    <span class="s2">&quot;my-collection&quot;</span><span class="p">,</span>
    <span class="p">{</span><span class="s2">&quot;page&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
    <span class="kc">True</span><span class="p">,</span>
    <span class="n">pager_settings</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;rows_per_page&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">}</span>
<span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">col</span> <span class="o">=</span> <span class="n">MyCollection</span><span class="p">(</span>
    <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="p">{},</span>
    <span class="n">pager_settings</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;rows_per_page&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">},</span>
<span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="use-collection-data">Use collection data</h2>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to try examples below, but you haven't defined any collection yet,
you can use the following definition for collection of numbers from 1 to 25:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">ckanext.collection.shared</span> <span class="kn">import</span> <span class="n">collection</span><span class="p">,</span> <span class="n">data</span>
<span class="k">class</span> <span class="nc">MyCollection</span><span class="p">(</span><span class="n">collection</span><span class="o">.</span><span class="n">Collection</span><span class="p">):</span>
    <span class="n">DataFactory</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">StaticData</span><span class="o">.</span><span class="n">with_attributes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;number&quot;</span><span class="p">:</span> <span class="n">num</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="n">idx</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">26</span><span class="p">))</span>
    <span class="p">])</span>
</code></pre></div>
</div>
<p>Intended way to access the data is iteration over collection instance. In this
way, you access only specific chunk of data, limited by collection's pager.</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">col</span> <span class="o">=</span> <span class="n">MyCollection</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
<span class="go">[{&#39;number&#39;: 1, &#39;index&#39;: 0},</span>
<span class="go"> {&#39;number&#39;: 2, &#39;index&#39;: 1},</span>
<span class="go"> {&#39;number&#39;: 3, &#39;index&#39;: 2},</span>
<span class="go"> {&#39;number&#39;: 4, &#39;index&#39;: 3},</span>
<span class="go"> {&#39;number&#39;: 5, &#39;index&#39;: 4},</span>
<span class="go"> {&#39;number&#39;: 6, &#39;index&#39;: 5},</span>
<span class="go"> {&#39;number&#39;: 7, &#39;index&#39;: 6},</span>
<span class="go"> {&#39;number&#39;: 8, &#39;index&#39;: 7},</span>
<span class="go"> {&#39;number&#39;: 9, &#39;index&#39;: 8},</span>
<span class="go"> {&#39;number&#39;: 10, &#39;index&#39;: 9}]</span>
</code></pre></div>
<p>Different page can be accessed by passing <code>page</code> inside params to collection's
constructor</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">col</span> <span class="o">=</span> <span class="n">MyCollection</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;page&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span> <span class="c1"># (1)!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
<span class="go">[{&#39;number&#39;: 21, &#39;index&#39;: 20},</span>
<span class="go"> {&#39;number&#39;: 22, &#39;index&#39;: 21},</span>
<span class="go"> {&#39;number&#39;: 23, &#39;index&#39;: 22},</span>
<span class="go"> {&#39;number&#39;: 24, &#39;index&#39;: 23},</span>
<span class="go"> {&#39;number&#39;: 25, &#39;index&#39;: 24}]</span>
</code></pre></div>
<ol>
<li>More idiomatic form of this initialization is <code class="highlight"><span class="n">MyCollection</span><span class="p">(</span><span class="n">pager_settings</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;page&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}))</span></code>. But this form is longer an
   required deeper knowledge of collections.</li>
</ol>
<p>If you need to iterate over all collection items, without pagination, you can
use <code>data</code> attribute of the collection.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Using data directly can result in enormous memory consumption. Avoid
transforming data into list(<code class="highlight"><span class="nb">list</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">data</span><span class="p">)</span></code>) or processing it as single object
in any other way. Instead, iterate over collection items using loops or similar
tools.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="nb">sum</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">col</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">sum</span> <span class="o">+=</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;number&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">sum</span><span class="p">)</span>
<span class="go">325</span>
</code></pre></div>
</div>
<h2 id="serialize-collection">Serialize collection</h2>
<p>The ultimate goal of every collection is serialization. It may be serialization
as HTML to show collection on one of application web-pages. Or serialization as
JSON to send collection to the external API. Or serialization as CSV to allow
user downloading the collection. Or even serialization as pandas' DataFrame to
process data from the collection using more advanced tools.</p>
<p><code>serializer</code> service of collection is responsible for serialization. If
required format of collections output is known in advance, <code>SerializerFactory</code>
can be defined on collection level.</p>
<p>If the format of serialization can vary, <code>serializer</code> can be initialized
separately.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">Using SerializerFactory</label><label for="__tabbed_3_2">Creating serializers on demand</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">ckanext.collection.shared</span> <span class="kn">import</span> <span class="n">collection</span><span class="p">,</span> <span class="n">serialize</span><span class="p">,</span> <span class="n">data</span>

<span class="k">class</span> <span class="nc">MyCollection</span><span class="p">(</span><span class="n">collection</span><span class="o">.</span><span class="n">Collection</span><span class="p">):</span>
    <span class="n">DataFactory</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">StaticData</span><span class="o">.</span><span class="n">with_attributes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;number&quot;</span><span class="p">:</span> <span class="n">num</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="n">idx</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">26</span><span class="p">))</span>
    <span class="p">])</span>
    <span class="n">SerializerFactory</span> <span class="o">=</span> <span class="n">serialize</span><span class="o">.</span><span class="n">CsvSerializer</span>

<span class="n">col</span> <span class="o">=</span> <span class="n">MyCollection</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">serializer</span><span class="o">.</span><span class="n">serialize</span><span class="p">())</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">ckanext.collection.shared</span> <span class="kn">import</span> <span class="n">collection</span><span class="p">,</span> <span class="n">serialize</span><span class="p">,</span> <span class="n">data</span>

<span class="k">class</span> <span class="nc">MyCollection</span><span class="p">(</span><span class="n">collection</span><span class="o">.</span><span class="n">Collection</span><span class="p">):</span>
    <span class="n">DataFactory</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">StaticData</span><span class="o">.</span><span class="n">with_attributes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;number&quot;</span><span class="p">:</span> <span class="n">num</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="n">idx</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">26</span><span class="p">))</span>
    <span class="p">])</span>


<span class="n">col</span> <span class="o">=</span> <span class="n">MyCollection</span><span class="p">()</span>

<span class="n">json</span> <span class="o">=</span> <span class="n">serialize</span><span class="o">.</span><span class="n">JsonSerializer</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">serialize</span><span class="p">())</span>

<span class="n">csv</span> <span class="o">=</span> <span class="n">serialize</span><span class="o">.</span><span class="n">CsvSerializer</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">serialize</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Keep in mind, as any other collection's service, serializer attaches itself to
collection when initialized and replaces the previous serializer.</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">col</span> <span class="o">=</span> <span class="n">MyCollection</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">serializer</span><span class="p">,</span> <span class="n">serialize</span><span class="o">.</span><span class="n">Serializer</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">serialize</span><span class="o">.</span><span class="n">JsonSerializer</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">serializer</span><span class="p">,</span> <span class="n">serialize</span><span class="o">.</span><span class="n">JsonSerializer</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">serialize</span><span class="o">.</span><span class="n">CsvSerializer</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">serializer</span><span class="p">,</span> <span class="n">serialize</span><span class="o">.</span><span class="n">CsvSerializer</span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../installation/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Installation">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Installation
              </div>
            </div>
          </a>
        
        
          
          <a href="../interfaces/" class="md-footer__link md-footer__link--next" aria-label="Next: Interfaces">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Interfaces
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.footer", "navigation.indexes", "navigation.top", "content.code.copy", "content.code.select", "content.code.annotate"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
    
  </body>
</html>